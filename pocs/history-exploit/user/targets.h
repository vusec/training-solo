/*
 * Friday, March 22th 2024
 *
 * Sander Wiebing - s.j.wiebing@vu.nl
 * Cristiano Giuffrida - giuffrida@cs.vu.nl
 *
 * Vrije Universiteit Amsterdam - Amsterdam, The Netherlands
 *
 */


#ifndef _TARGETS_H_
#define _TARGETS_H_

#include <sys/syscall.h>

#define VICTIM_SYSCALL SYS_prctl

#define SECURITY_LIST_PC_OFFSET 0x1d49688     // 0xffffffff82d49688
#define TRANSMISSION_PC_OFFSET  0x023c2ad     // 0xffffffff8123c2ad rebind_subsystems

#define T_BASE_OFFSET 0x0
#define T_SECRET_ADDR__OFFSET 0x18
#define STRIDE          1


#define MAX_HISTORY_SIZE 512
#define THR 80

#define PATH_TRIGGER_TARGET "/proc/post_native_bhi/trigger_target"
#define PATH_PHYS_MAP "/proc/post_native_bhi/phys_map_start"

#if defined(INTEL_10_GEN)
    #define COLLISION_TRIES 250

#elif defined(INTEL_11_GEN)
    #define COLLISION_TRIES 1000

#elif defined(INTEL_LION_COVE)
    #define COLLISION_TRIES 1000

#else
    #error "Not supported micro-architecture"
    // silence undefined errors
    #define COLLISION_TRIES 1
#endif

#endif //_TARGETS_H_
